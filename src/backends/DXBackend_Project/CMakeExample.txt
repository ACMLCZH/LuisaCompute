add_library(DXBackend_Project MODULE ${DX_BACKEND_SOURCES})
target_compile_definitions(DXBackend_Project PRIVATE
_UNICODE)
target_include_directories(DXBackend_Project PRIVATE ${CMAKE_CURRENT_LIST_DIR})
if (MSVC)
    target_compile_options(DXBackend_Project PRIVATE 
                           /JMC
                           /permissive-
                           /MP
                           /GS /TP /Qpar /GL /W0 /Gy
                           /Zi /Gm- /O2
                           /sdl- /GT
                           /QIntel-jcc-erratum /WX- /Zc:forScope
                           /Zc:inline /fp:precise
                           /arch:AVX2 /Gr /Oy /Oi /MD
                           /std:c++latest /FC
                           /nologo
                           /Ot
                           )
    target_link_options(DXBackend_Project PRIVATE 
                        /MANIFEST /LTCG:incremental /NXCOMPAT
                        /OPT:REF /INCREMENTAL:NO
                        /NOLOGO
                        /TLBID:1 
                        /OPT:ICF /ERRORREPORT:PROMPT
                        )
endif()

target_link_libraries(DXBackend_Project PUBLIC luisa-compute-ast)
set_target_properties(DXBackend_Project PROPERTIES
                      WINDOWS_EXPORT_ALL_SYMBOLS OFF
                      UNITY_BUILD ON)