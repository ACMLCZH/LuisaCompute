if (WIN32)

    message(STATUS "Build with DirectX")

    luisa_compute_add_backend(dx SOURCES ${DX_BACKEND_SOURCES})
    target_include_directories(luisa-compute-backend-dx PRIVATE ${CMAKE_CURRENT_SOURCE_DIR})

    if (MSVC)
        target_compile_options(luisa-compute-backend-dx PRIVATE
                               /JMC
                               /permissive-
                               /MP
                               /GS /TP /Qpar /GL /W0 /Gy
                               /Zi /Gm-
                               /sdl- /GT
                               $<$<NOT:$<CXX_COMPILER_ID:Clang>>:/QIntel-jcc-erratum>
                               /WX- /Zc:forScope
                               /Zc:inline /fp:precise
                               /arch:AVX2 /Gr /Oy /Oi
                               /std:c++latest /FC
                               /nologo
                               /Ot)

        target_link_options(luisa-compute-backend-dx PRIVATE
                            /MANIFEST /LTCG:incremental /NXCOMPAT
                            /OPT:REF /INCREMENTAL:NO
                            /NOLOGO
                            /TLBID:1
                            /OPT:ICF /ERRORREPORT:PROMPT)
    endif ()

    target_link_libraries(luisa-compute-backend-dx PRIVATE luisa-compute-ast)
    set_target_properties(luisa-compute-backend-dx PROPERTIES WINDOWS_EXPORT_ALL_SYMBOLS OFF)

endif ()
